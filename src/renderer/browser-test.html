<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Browser Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 20px;
            margin: 0;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
        }
        .test-item {
            background: #f5f5f5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .test-item h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .test-result {
            font-weight: bold;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
    </style>
</head>
<body>
    <div class="test-container">
        <h2>PalamBlock - Test de Navegador</h2>
        
        <div class="test-item">
            <h3>Test de Connexió</h3>
            <p>Provant connexió amb el servidor PalamBlock...</p>
            <div class="test-result" id="connectionTest">
                <span class="warning">⏳ Provant...</span>
            </div>
        </div>
        
        <div class="test-item">
            <h3>Test de WebSocket</h3>
            <p>Verificant connexió WebSocket amb l'administració...</p>
            <div class="test-result" id="websocketTest">
                <span class="warning">⏳ Provant...</span>
            </div>
        </div>
        
        <div class="test-item">
            <h3>Test d'Extensió</h3>
            <p>Comprovant si l'extensió PalamBlock està instal·lada...</p>
            <div class="test-result" id="extensionTest">
                <span class="warning">⏳ Provant...</span>
            </div>
        </div>
        
        <div class="test-item">
            <h3>Informació del Navegador</h3>
            <p><strong>User Agent:</strong> <span id="userAgent"></span></p>
            <p><strong>Navegador:</strong> <span id="browserName"></span></p>
            <p><strong>Versió:</strong> <span id="browserVersion"></span></p>
        </div>
    </div>

    <script>
        // Test de connexió
        setTimeout(() => {
            const connectionTest = document.getElementById('connectionTest');
            // Skip connection test in Electron app (no server URL available here)
            connectionTest.innerHTML = '<span class="warning">⚠️ Test desactivat en Electron</span>';
        }, 1000);

        // Test de WebSocket
        setTimeout(() => {
            const websocketTest = document.getElementById('websocketTest');
            try {
                const socket = io();
                socket.on('connect', () => {
                    websocketTest.innerHTML = '<span class="success">✅ WebSocket OK</span>';
                    socket.disconnect();
                });
                socket.on('connect_error', () => {
                    websocketTest.innerHTML = '<span class="error">❌ WebSocket error</span>';
                });
            } catch (error) {
                websocketTest.innerHTML = '<span class="error">❌ WebSocket no disponible</span>';
            }
        }, 2000);

        // Test d'extensió
        setTimeout(() => {
            const extensionTest = document.getElementById('extensionTest');
            if (window.palamblock) {
                extensionTest.innerHTML = '<span class="success">✅ Extensió detectada</span>';
            } else {
                extensionTest.innerHTML = '<span class="warning">⚠️ Extensió no detectada</span>';
            }
        }, 3000);

        // Informació del navegador
        document.getElementById('userAgent').textContent = navigator.userAgent;
        
        const getBrowserInfo = () => {
            const ua = navigator.userAgent;
            if (ua.includes('Chrome') && !ua.includes('Edg')) {
                return { name: 'Chrome', version: ua.match(/Chrome\/(\d+)/)?.[1] || 'Unknown' };
            } else if (ua.includes('Edg')) {
                return { name: 'Edge', version: ua.match(/Edg\/(\d+)/)?.[1] || 'Unknown' };
            } else if (ua.includes('Firefox')) {
                return { name: 'Firefox', version: ua.match(/Firefox\/(\d+)/)?.[1] || 'Unknown' };
            } else if (ua.includes('Safari') && !ua.includes('Chrome')) {
                return { name: 'Safari', version: ua.match(/Version\/(\d+)/)?.[1] || 'Unknown' };
            }
            return { name: 'Unknown', version: 'Unknown' };
        };
        
        const browserInfo = getBrowserInfo();
        document.getElementById('browserName').textContent = browserInfo.name;
        document.getElementById('browserVersion').textContent = browserInfo.version;
    </script>
</body>
</html>